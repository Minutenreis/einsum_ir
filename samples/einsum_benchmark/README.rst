Einsum Benchmark
----------------
The script ``benchmark_convert.py`` can be used to convert benchmarks from https://benchmark.einsum.org/ to a format suitable for einsum_ir.

.. code-block:: bash

   wget https://zenodo.org/records/11477304/files/instances.zip -O instances.zip
   unzip instances.zip
   python benchmark_convert.py instances/lm_first_last_brackets_4_16d.pkl > lm_first_last_brackets_4_16d.cfg
   python benchmark_convert.py instances/lm_batch_likelihood_sentence_5_16d.pkl | sed 's/3500/128/g' > lm_batch_likelihood_sentence_5_16d_batch128.cfg
   python benchmark_convert.py instances/str_nw_mera_open_26.pkl > str_nw_mera_open_26.cfg

The configs ``synthetic_et.cfg``, ``lm_first_last_brackets_4_16d_et.cfg`` and ``str_nw_mera_open_26_et.cfg`` contain respective einsum trees optimized by the simple internal heuristic of einsum_ir (version #c600e8a).

TVM
---
The TVM settings were generated by converting the internal einsum trees from einsum_ir (version #de7d468).

.. code-block:: bash

   python ../tools/tvm_from_tree.py --einsum_tree "[[[8,0,9,4]->[0,9,4,8]],[[2,8,6,9]->[6,2,9,8]]->[6,2,0,4,8]],[[[[3,2,1,0]->[3,1,2,0]],[[1,5]->[5,1]]->[5,3,2,0]],[[3,7]->[7,3]]->[7,5,2,0]]->[7,6,5,4,8]" --dim_sizes "24,48,12,56,32,64,8,84,8,72" > synthetic_tvm.py

   python ../tools/tvm_from_tree.py --einsum_tree "[[[[[8,9,44]->[9,8,44]],[[17,9,11]->[11,17,9]]->[11,17,8,44]],[7,8]->[11,17,7,44]],[[6,7,43]->[6,43,7]]->[11,6,17,43,44]],[[[[[[[[15,17,31]->[15,31,17]],[[30,31,32,33]->[32,30,33,31]]->[32,30,15,33,17]],[[[[[13,15,19]->[19,13,15]],[[[12,13],[[12,14,18]->[14,18,12]]->[14,18,13]],[[18,19,20,21]->[20,21,19,18]]->[14,20,21,19,13]]->[14,20,21,15]],[[21,27,30]->[27,30,21]]->[14,20,27,30,15]],[[[26,27,28,29]->[28,29,26,27]],[[20,23,26]->[23,20,26]]->[23,28,29,20,27]]->[14,23,28,29,30,15]]->[14,23,28,29,32,33,17]],[[[29,32,1,2]->[1,2,29,32]],[[2,3,41]->[41,3,2]]->[41,1,3,29,32]]->[41,14,23,1,28,3,33,17]],[[33,3,4]->[4,3,33]]->[41,14,23,1,28,4,17]],[[[[[25,28,37,0]->[25,37,0,28]],[[0,1,40]->[40,1,0]]->[40,25,37,1,28]],[[36,37,39]->[39,36,37]]->[39,40,36,25,1,28]],[[[[[[22,23,24,25]->[23,22,24,25]],[[24,35,36]->[35,36,24]]->[23,35,22,36,25]],[14,16,22]->[14,23,35,16,36,25]],[[16,34,10]->[10,34,16]]->[10,14,23,35,34,36,25]],[[34,35,38]->[38,35,34]]->[10,38,14,23,36,25]]->[10,38,14,23,39,40,1,28]]->[10,38,39,40,41,4,17]],[[[4,5,42]->[42,5,4]],[[5,6]->[6,5]]->[42,6,4]]->[10,38,39,40,41,42,6,17]]->[10,11,38,39,40,41,42,43,44]" --dim_sizes "56,7,48,4,11,20,5,6,25,79,3,3,13,9,5,27,17,10,46,7,15,25,19,6,68,22,26,24,22,7,9,68,8,6,17,5,7,11,9,9,9,9,9,9,9" > str_nw_mera_open_26_tvm.py

   python ../tools/tvm_from_tree.py --einsum_tree "[[[[[81,87,24,25]->[24,87,81,25]],[[63,87,11]->[11,63,87]]->[11,24,63,81,25]],[[[[[70,75,81],[[77,65,53,70]->[65,77,53,70]]->[65,77,53,75,81]],[[[61,75,22,23]->[22,23,61,75]],[[53,83,61]->[83,53,61]]->[22,23,83,53,75]]->[65,22,23,77,83,81]],[[[[[[66,83,20,21]->[20,21,66,83]],[[5,6,20,21]->[6,5,20,21]]->[6,5,66,83]],[[[54,60,66],[[[[82,76,52,54]->[52,76,82,54]],[[59,76,77]->[77,59,76]]->[77,52,59,82,54]],[[[85,57,82]->[57,85,82]],[[[64,78,85,59]->[64,78,59,85]],[[[79,78,86]->[86,79,78]],[[80,79],[[80,58,64]->[58,64,80]]->[58,64,79]]->[86,58,64,78]]->[86,58,59,85]]->[86,57,58,59,82]]->[86,77,52,57,58,54]]->[86,77,52,57,58,60,66]],[[[[[[71,60,18,19]->[18,19,71,60]],[3,4,18,19]->[3,4,71,60]],[[45,4,5]->[5,45,4]]->[5,3,45,71,60]],[52,84,71]->[52,5,3,45,84,60]],[[[[[[74,84,16,17]->[74,16,17,84]],[1,2,16,17]->[1,74,2,84]],[[[[[[[[72,56,74]->[56,72,74]],[[67,57,62,72]->[57,67,62,72]]->[57,67,56,62,74]],[[[62,69,73]->[69,73,62]],[[73,56,14,15]->[14,15,56,73]]->[14,15,69,56,62]]->[57,14,15,67,69,74]],[[[68,69,12,13]->[12,13,68,69]],[[[55,48,68]->[48,55,68]],[[58,55,67]->[58,67,55]]->[58,48,67,68]]->[58,12,13,48,67,69]]->[57,58,14,15,12,13,48,74]],[[[34,48,49]->[34,49,48]],[[49,50,12,13]->[50,12,13,49]]->[34,50,12,13,48]]->[57,58,34,14,15,50,74]],[[[42,50,51]->[42,51,50]],[[51,0,14,15]->[0,14,15,51]]->[0,14,42,15,50]]->[57,58,0,34,42,74]],[[[[35,36,42,43]->[36,43,35,42]],[[43,0,1]->[0,1,43]]->[36,0,1,35,42]],[28,34,35]->[28,36,0,1,34,42]]->[57,58,28,36,1,74]]->[57,58,28,36,2,84]],[[44,2,3]->[3,44,2]]->[57,3,58,28,36,44,84]],[[[[37,38,44,45]->[45,38,37,44]],[[33,38,39]->[39,33,38]]->[39,45,33,37,44]],[[[32,36,37]->[36,32,37]],[[[29,30,32,33]->[29,30,33,32]],[[[[27,30,31]->[31,27,30]],[26,27]->[31,26,30]],[[26,28,29]->[28,29,26]]->[31,28,29,30]]->[31,28,33,32]]->[31,28,36,33,37]]->[31,39,28,45,36,44]]->[31,39,57,3,58,45,84]]->[31,39,52,57,5,58,60]]->[86,31,39,77,5,66]]->[86,6,31,39,77,83]],[[[[39,40,46,47]->[47,46,40,39]],[[46,6,7]->[7,6,46]]->[7,6,47,40,39]],[[31,40,41]->[41,31,40]]->[41,7,6,47,31,39]]->[41,86,7,47,77,83]],[[[47,8,9]->[9,8,47]],[[7,8,22,23]->[22,23,7,8]]->[9,22,23,7,47]]->[9,41,22,23,86,77,83]]->[9,41,65,86,81]],[[86,65,63]->[63,65,86]]->[9,41,63,81]]->[11,24,9,41,25]],[[9,10,24,25]->[10,24,9,25]]->[11,10,41,25]],[[41,10,11]->[11,10,41]]->[11,25]" --dim_sizes "16,16,16,16,16,16,16,16,16,16,16,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,7,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16" > lm_first_last_brackets_4_16d_tvm.py