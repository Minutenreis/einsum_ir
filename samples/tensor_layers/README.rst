Tensor Layers
=====================

Blocked Fully Connected Layer
-----------------------------
Blocked fully connected layer in https://doi.org/10.1109/IPDPS47924.2020.00032.
The script ``fc.py`` was used to generate the configs in ``fc.cfg``.

.. code-block:: bash

   python fc.py > fc.cfg

Tensor Ring Nets
----------------
Tensor ring net (TRN) compression of a fully connected layer in https://doi.org/10.1109/CVPR.2018.00972 for the LeNet-300-100 network with R=50.
The script ``trn.py`` was used to compute the contraction path.
The config ``trn.cfg`` contains a corresponding einsum expression and contraction path for performance benchmarking. It was derived from the obtained output.
The config ``trn_et.cfg`` contains a respective einsum tree optimized by the simple internal heuristic of einsum_ir (version #c600e8a).
The TVM setting ``trn_tvm.py`` was generated by converting the internal einsum tree from einsum_ir (version #de7d468).

.. code-block:: bash

   python trn.py 2>&1 | tee trn.log
   python ../tools/tvm_from_tree.py --einsum_tree "[[[[[8,13,14]->[13,14,8]],[4,12,13]->[4,12,14,8]],[[3,11,12],[2,9,11]->[3,2,9,12]]->[3,2,4,9,14,8]],[[[[7,14,15]->[7,15,14]],[[6,15,16]->[6,16,15]]->[6,7,16,14]],[[5,10,16],[1,9,10]->[5,1,9,16]]->[5,1,9,6,7,14]]->[5,1,3,2,4,6,7,8]],[[0,1,2,3,4]->[1,0,3,2,4]]->[0,5,6,7,8]" --dim_sizes "128,4,7,4,7,3,4,5,5,50,50,50,50,50,50,50,50" > trn_tvm.py